plot(ep.df$TOT~ep.df$YEAR, ylab = "Electric Prices(Cents/Kilowatt Hour)", xlab = "Year", main = "Electric Price~Year", pch = 18, col = "Red")
x = 0:(length(ep.df$YEAR)-1)
ep.lm <- lm(TOT ~ x, data = ep.df)
trendscatter(ep.lm)
library(ggplot2)
x = 0:(length(ep.df$YEAR)-1)
ep.lm <- lm(TOT ~ x, data = ep.df)
g = ggplot(ep.lm, aes(x = x, y = TOT, color = x)) + geom_point()
#g = g + ylab("Electric Prices (Cents per Kilowatthour)") + xlab("Year") + ggtitle("Electric Price ~ Year", subtitle = NULL)
g = g + geom_smooth(method = "loess")
g
library(ggplot2)
x = 0:(length(ep.df$YEAR)-1)
ep.lm <- lm(TOT ~ x, data = ep.df)
g = ggplot(ep.lm, aes(x = x, y = TOT, color = x)) + geom_point()
#g = g + ylab("Electric Prices (Cents per Kilowatthour)") + xlab("Year") + ggtitle("Electric Price ~ Year", subtitle = NULL)
g = g + geom_smooth(method = "loess")
g
plot(ep.df$TOT~x, ylim = c(0, max(ep.df$TOT) + 1), xlim = c(0, max(x)))#, ylab = "Electric Prices (Cents per Kilowatthour)", xlab = "Year", main = "Plot of Theoretical Model with Data")
abline(ep.summary$b0hat, ep.summary$b1hat, lwd = 2, col = "Blue")
x = 0:(length(ep.df$YEAR)-1)
ep.lm <- lm(TOT ~ x, data = ep.df)
library(s20x)
trendscatter(ep.lm, f = 1, ylim = c(0,11), main = "Energy Prices ~ Years", xlab = "Year", ylab = "Energy Prices")
x = 0:(length(ep.df$YEAR)-1)
ep.lm <- lm(TOT ~ x, data = ep.df)
library(s20x)
trendscatter(ep.lm$residuals~ep.lm$fitted.values, f = 1, ylim = c(0,11), main = "Energy Prices ~ Years", xlab = "Year", ylab = "Energy Prices")
x = 0:(length(ep.df$YEAR)-1)
ep.lm <- lm(TOT ~ x, data = ep.df)
library(s20x)
trendscatter(ep.lm$residuals~ep.lm$fitted.values, f = 1, ylim = c(-2,2), main = "Energy Prices ~ Years", xlab = "Year", ylab = "Energy Prices")
x = 0:(length(ep.df$YEAR)-1)
ep.lm <- lm(TOT ~ x, data = ep.df)
library(s20x)
trendscatter(ep.df$TOT~ep.df$YEAR, f = 1, ylim = c(-2,2), main = "Energy Prices ~ Years", xlab = "Year", ylab = "Energy Prices")
x = 0:(length(ep.df$YEAR)-1)
ep.lm <- lm(TOT ~ x, data = ep.df)
library(s20x)
trendscatter(ep.df$TOT~ep.df$YEAR, f = 1, ylim = c(0,10), main = "Energy Prices ~ Years", xlab = "Year", ylab = "Energy Prices")
x = 0:(length(ep.df$YEAR)-1)
ep.lm <- lm(TOT ~ x, data = ep.df)
library(s20x)
trendscatter(ep.df$TOT~ep.df$YEAR, f = 0.7, ylim = c(0,10), main = "Energy Prices ~ Years", xlab = "Year", ylab = "Energy Prices")
library(s20x)
normcheck(ep.lm, shapiro.wilk = TRUE)
trendscatter((1/ep.lm$residuals)~ep.lm$fitted.values, f = 0.5, main = "Residuals ~ Fitted Values", ylab = "Residuals", xlab = "Fitted Values")
trendscatter((ep.lm$residuals)~ep.lm$fitted.values, f = 0.5, main = "Residuals ~ Fitted Values", ylab = "Residuals", xlab = "Fitted Values")
trendscatter((1/ep.lm$residuals)~ep.lm$fitted.values, f = 0.5, main = "Residuals ~ Fitted Values", ylab = "Residuals", xlab = "Fitted Values")
trendscatter((1/ep.lm$residuals)~ep.lm$fitted.values, f = 0.5, main = "Residuals ~ Fitted Values", ylab = "Residuals", xlab = "Fitted Values", ylim = c(-15,15))
tran.lm = ep.lm
tran.lm$residuals = 1/tran.lm$residuals
library(s20x)
normcheck(tran.lm, shapiro.wilk = TRUE)
tran.lm = ep.lm
tran.lm$residuals = sqrt(tran.lm$residuals)
library(s20x)
normcheck(tran.lm, shapiro.wilk = TRUE)
tran.lm = ep.lm
tran.lm$residuals = sqrt(tran.lm$residuals)
library(s20x)
normcheck(tran.lm, shapiro.wilk = TRUE, xlim = c(-100,100))
tran.lm = ep.lm
tran.lm$residuals = ln(tran.lm$residuals)
tran.lm = ep.lm
tran.lm$residuals = log(tran.lm$residuals)
library(s20x)
normcheck(tran.lm, shapiro.wilk = TRUE, xlim = c(-100,100))
tran.lm = ep.lm
tran.lm$residuals = 1/(tran.lm$residuals)
library(s20x)
normcheck(tran.lm, shapiro.wilk = TRUE, xlim = c(-100,100))
tran.lm = ep.lm
tran.lm$residuals = 1/(tran.lm$residuals)
library(s20x)
normcheck(tran.lm, shapiro.wilk = TRUE)
tran.lm = ep.lm
tran.lm$residuals = log(tran.lm$residuals)
library(s20x)
normcheck(tran.lm, shapiro.wilk = TRUE)
tran.lm = ep.lm
tran.lm$residuals = log(tran.lm$residuals)
library(s20x)
normcheck(tran.lm, shapiro.wilk = TRUE, xlim = c(-10,10))
tran.lm = ep.lm
tran.lm$residuals = log(tran.lm$residuals)
library(s20x)
normcheck(tran.lm, shapiro.wilk = TRUE, xlim = c(min(tran.lm$residuals),max(tran.lm$residuals)))
tran.lm = ep.lm
tran.lm$residuals = sqrt(tran.lm$residuals)
library(s20x)
normcheck(tran.lm, shapiro.wilk = TRUE, xlim = c(min(tran.lm$residuals),max(tran.lm$residuals)))
tran.lm = ep.lm
tran.lm$residuals = 1/(tran.lm$residuals)
library(s20x)
normcheck(tran.lm, shapiro.wilk = TRUE, xlim = c(min(tran.lm$residuals),max(tran.lm$residuals)))
tran.lm = ep.lm
tran.lm$residuals = 1/(tran.lm$residuals)
library(s20x)
normcheck(tran.lm, shapiro.wilk = TRUE)
plot(ep.lm, which =1, pch = 19)
plot(ep.lm, which =1, pch = 19)
trans.lm = ep.lm
trans.lm$residuals = 1/trans.lm$residuals
plot(trans.lm, which =1, pch = 19)
plot(ep.lm, which =1, pch = 19)
trans.lm = ep.lm
trans.lm$residuals = 1/trans.lm$residuals
library(s20x)
normcheck(trans.lm, shapiro.wilk = TRUE)
trans.lm = ep.lm
trans.lm$residuals = log(trans.lm$residuals)
library(s20x)
normcheck(trans.lm, shapiro.wilk = TRUE)
trans.lm = ep.lm
trans.lm$residuals = 1/trans.lm$residuals
plot(trans.lm, which =1, pch = 19)
mysample <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
library(s20x)
normcheck(trans.lm, shapiro.wilk = TRUE)
sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
sam.lm <- lm(TOT ~ x, data = sam)
sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam)
sam.lm <- lm(TOT ~ samx, data = sam)
sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(trans.lm, shapiro.wilk = TRUE)
sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
set.seed(1);sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
set.seed(1);sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
set.seed(2);sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
set.seed(3);sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
set.seed(4);sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
set.seed(5);sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
set.seed(6);sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
set.seed(7);sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
set.seed(8);sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
set.seed(9);sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
set.seed(10);sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
set.seed(11);sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
set.seed(12);sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
set.seed(13);sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
set.seed(14);sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
set.seed(15);sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
set.seed(16);sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
set.seed(17);sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
set.seed(18);sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
set.seed(19);sam <- ep.df[sample(1:nrow(ep.df), 30,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
plot(sam.lm, which =1, pch = 19)
trans.lm = ep.lm
trans.lm$residuals = 1/trans.lm$residuals
plot(sam.lm, which =1, pch = 19)
trans.lm = sam.lm
sam.lm$residuals = 1/sam.lm$residuals
plot(sam.lm, which =1, pch = 19)
trans.lm = sam.lm
sam.lm$residuals = sqrt(sam.lm$residuals)
plot(sam.lm, which =1, pch = 19)
trans.lm = sam.lm
sam.lm$residuals = log(sam.lm$residuals)
plot(sam.lm, which =1, pch = 19)
set.seed(19);sam <- ep.df[sample(1:nrow(ep.df), 31,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
library(s20x)
normcheck(sam.lm, shapiro.wilk = TRUE)
summary(ep.lm)
summary(ep.lm)
e = summary(ep.lm)
e = summary(ep.lm)$r.squared
summary(ep.lm)$r.squared
e = summary(ep.lm)
summary(ep.lm)$coefficients
plot(ep.df$TOT~x)
e= summary(ep.lm)$coefficients
summary(ep.lm)$coefficients
plot(ep.df$TOT~x)
abline(0.9124, 0.1716)
plot(ep.df$TOT~x)
abline(0.9124, 0.1716)
abline(0.9124+0.2012, 0.1716-0.0068)
plot(ep.df$TOT~x)
abline(0.9124, 0.1716)
abline(0.9124+0.2012, 0.1716-0.0068)
abline(0.9124-0.2012, 0.1716+0.0068)
plot(ep.df$TOT~x)
abline(0.9124, 0.1716)
abline(0.9124-1.75*sd(ep.lm$residuals), 0.1716-0.0068)
abline(0.9124-0.2012, 0.1716+0.0068)
plot(ep.df$TOT~x)
abline(0.9124, 0.1716)
abline(0.9124-1.75*sd(ep.lm$residuals), 0.1716)
abline(0.9124+1.75*sd(ep.lm$residuals), 0.1716)
plot(ep.df$TOT~x)
abline(0.9124, 0.1716)
abline(0.9124-1.5*sd(ep.lm$residuals), 0.1716)
abline(0.9124+1.5*sd(ep.lm$residuals), 0.1716)
plot(ep.df$TOT~x)
abline(0.9124, 0.1716)
abline(0.9124-1.25*sd(ep.lm$residuals), 0.1716)
abline(0.9124+1.25*sd(ep.lm$residuals), 0.1716)
b0 = 0.9124-.1716*1960
plot(ep.df$TOT~ep.df$YEAR, ylab = "Electric Prices", xlab = "Year")
abline(b0, 0.1716)
abline(b0-1.25*sd(ep.lm$residuals), 0.1716)
abline(b0+1.25*sd(ep.lm$residuals), 0.1716)
b0 = 0.9124-.1716*1960
plot(ep.df$TOT~x, ylab = )
abline(0.9124, 0.1716)
abline(0.9124-1.25*sd(ep.lm$residuals), 0.1716)
abline(0.9124+1.25*sd(ep.lm$residuals), 0.1716)
b0 = 0.9124-.1716*1960
plot(ep.df$TOT~ep.df$YEAR, ylab = "Electric Prices", xlab = "Year")
abline(b0, 0.1716)
abline(b0-1.25*sd(ep.lm$residuals), 0.1716)
abline(b0+1.25*sd(ep.lm$residuals), 0.1716)
b0 = 0.9124-.1716*1960
plot(ep.df$TOT~ep.df$YEAR, ylab = "Electric Prices", xlab = "Year", main = "Least Squares Regression Line")
abline(b0, 0.1716)
abline(b0-1.25*sd(ep.lm$residuals), 0.1716)
abline(b0+1.25*sd(ep.lm$residuals), 0.1716)
b0 = 0.9124-.1716*1960
plot(ep.df$TOT~ep.df$YEAR, ylab = "Electric Prices", xlab = "Year", main = "Least Squares Regression Line")
abline(b0, 0.1716)
abline(b0-sd(ep.lm$residuals), 0.1716)
abline(b0+sd(ep.lm$residuals), 0.1716)
b0 = 0.9124-.1716*1960
plot(ep.df$TOT~ep.df$YEAR, ylab = "Electric Prices", xlab = "Year", main = "Least Squares Regression Line", col= ifelse(ep.lm$residuals >= sd(ep.lm$residuals), "Red", ifelse(ep.lm$residuals <= -sd(sd(ep.lm$residuals)), "red", "Black")))
abline(b0, 0.1716)
abline(b0-sd(ep.lm$residuals), 0.1716)
abline(b0+sd(ep.lm$residuals), 0.1716)
b0 = 0.9124-.1716*1960
plot(ep.df$TOT~ep.df$YEAR, ylab = "Electric Prices", xlab = "Year", main = "Least Squares Regression Line", col= ifelse(ep.lm$residuals >= sd(ep.lm$residuals), "Red", ifelse(ep.lm$residuals <= -sd(ep.lm$residuals), "red", "Black")))
abline(b0, 0.1716)
abline(b0-sd(ep.lm$residuals), 0.1716)
abline(b0+sd(ep.lm$residuals), 0.1716)
b0 = 0.9124-.1716*1960
plot(ep.df$TOT~ep.df$YEAR, ylab = "Electric Prices", xlab = "Year", main = "Least Squares Regression Line", pch = 17, col= ifelse(ep.lm$residuals >= sd(ep.lm$residuals), "Red", ifelse(ep.lm$residuals <= -sd(ep.lm$residuals), "red", "Black")))
abline(b0, 0.1716)
abline(b0-sd(ep.lm$residuals), 0.1716)
abline(b0+sd(ep.lm$residuals), 0.1716)
b0 = 0.9124-.1716*1960
plot(ep.df$TOT~ep.df$YEAR, ylab = "Electric Prices", xlab = "Year", main = "Least Squares Regression Line", pch = 18, col= ifelse(ep.lm$residuals >= sd(ep.lm$residuals), "Red", ifelse(ep.lm$residuals <= -sd(ep.lm$residuals), "red", "Black")))
abline(b0, 0.1716)
abline(b0-sd(ep.lm$residuals), 0.1716)
abline(b0+sd(ep.lm$residuals), 0.1716)
b0 = 0.9124-.1716*1960
plot(ep.df$TOT~ep.df$YEAR, ylab = "Electric Prices", xlab = "Year", main = "Least Squares Regression Line", pch = 19, col= ifelse(ep.lm$residuals >= sd(ep.lm$residuals), "Red", ifelse(ep.lm$residuals <= -sd(ep.lm$residuals), "red", "Black")))
abline(b0, 0.1716)
abline(b0-sd(ep.lm$residuals), 0.1716)
abline(b0+sd(ep.lm$residuals), 0.1716)
b0 = 0.9124-.1716*1960
plot(ep.df$TOT~ep.df$YEAR, ylab = "Electric Prices", xlab = "Year", main = "Least Squares Regression Line", pch = 19, col= ifelse(ep.lm$residuals >= sd(ep.lm$residuals), "Red", ifelse(ep.lm$residuals <= -sd(ep.lm$residuals), "red", "Black")))
abline(b0, 0.1716)
abline(b0-sd(ep.lm$residuals), 0.1716, col = "Red")
abline(b0+sd(ep.lm$residuals), 0.1716, col = "Red")
b0 = 0.9124-.1716*1960
plot(ep.df$TOT~ep.df$YEAR, ylab = "Electric Prices", xlab = "Year", main = "Least Squares Regression Line", pch = 19, col= ifelse(ep.lm$residuals >= sd(ep.lm$residuals), "Yellow", ifelse(ep.lm$residuals <= -sd(ep.lm$residuals), "Yellow", "Black")))
abline(b0, 0.1716)
abline(b0-sd(ep.lm$residuals), 0.1716, col = "Red")
abline(b0+sd(ep.lm$residuals), 0.1716, col = "Red")
set.seed(19);sam <- ep.df[sample(1:nrow(ep.df), 31,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
summary(sam.lm)$r.squared
1-.9272
set.seed(19);sam <- ep.df[sample(1:nrow(ep.df), 31,
replace=FALSE),]
samx = 1:length(sam$YEAR)
sam.lm <- lm(TOT ~ samx, data = sam)
1-summary(sam.lm)$r.squared
knitr::opts_chunk$set(echo = TRUE)
ep.df <- read.csv("ep.csv")
head(ep.df)
names(ep.df)
library(ggplot2)
x = 0:(length(ep.df$YEAR)-1)
ep.lm <- lm(TOT ~ x, data = ep.df)
g = ggplot(ep.lm, aes(x = x, y = TOT, color = x)) + geom_point()
g = g + ylab("Electric Prices (Cents per Kilowatthour)") + xlab("Year") + ggtitle("Electric Price ~ Year", subtitle = NULL)
g = g + geom_smooth(method = "loess")
g
mysummary = function(x=x,y=y){
ssxx  = sum((x - mean(x)) ^ 2)
ssxy  = sum((x - mean(x)) * (y - mean(y)))
ssyy  = sum((y - mean(y)) ^ 2)
b1hat = ssxy / ssxx
b0hat = mean(y) - b1hat * mean(x)
yhat  = b0hat + b1hat * x
rss   = sum((y - yhat) ^ 2)
mss   = sum((yhat - mean(y)) ^ 2)
tss   = sum((y - mean(y)) ^ 2)
yerr  = y - yhat
rerr  = y - b0hat - b1hat*x
sdhat = sd(y) / ssxx
r     = ssxy / sqrt(ssxx*ssyy)
return(list(ssxx = ssxx, ssxy = ssxy, ssyy = ssyy, b1hat = b1hat, b0hat = b0hat, yhat = yhat, rss = rss, mss = mss, tss = tss, yerr = yerr, rerr = rerr, sdhat = sdhat, r = r))
}
ep.summary = mysummary(x, ep.df$TOT)
ep.summary$ssxx
var(x) * (length(x) - 1)
ep.summary$ssxy
cov(x,ep.df$TOT) * (length(x) - 1)
ep.summary$b1hat
ep.summary$b0hat
ep.summary$yerr
ep.summary$rss
sum(ep.summary$yerr^2)
ep.summary$mss
ep.summary$tss
var(ep.df$TOT) * (length(ep.df$TOT) - 1)
ep.summary$mss + ep.summary$rss
ep.summary$yhat
ep.summary$b0hat+ep.summary$b1hat*x+ep.summary$rerr
ep.df$TOT
plot(ep.df$TOT~x, ylim = c(0, max(ep.df$TOT) + 1), xlim = c(0, max(x)), ylab = "Electric Prices (Cents per Kilowatthour)", xlab = "Year", main = "Plot of Theoretical Model with Data")
abline(ep.summary$b0hat, ep.summary$b1hat, lwd = 2, col = "Blue")
with(ep.df, {
plot(TOT~x,bg="Blue",pch=21,ylim=c(0,1.1*max(TOT)),xlim=c(min(x)-1,max(x)+1), ylab = "Electric Prices (Cents per Kilowatthour)", xlab = "Year", main = "Plot of Theoretical Model with Data")
abline(ep.lm)
})
with(ep.df, {
plot(TOT~x,bg="Blue",pch=21,ylim=c(0,1.1*max(TOT)),xlim=c(min(x),max(x)), ylab = "Electric Prices (Cents per Kilowatthour)", xlab = "Year")
segments(x,TOT,x,ep.summary$yhat)
abline(ep.lm)
mtext("Diff between Point and Expected Point")
})
with(ep.df, {
plot(TOT~x,bg="Blue",pch=21,ylim=c(0,1.1*max(TOT)),xlim=c(min(x),max(x)), ylab = "Electric Prices (Cents per Kilowatthour)", xlab = "Year")
abline(ep.lm)
abline(h=mean(TOT))
segments(x,mean(TOT),x,ep.summary$yhat,col="Red")
mtext("Diff between Linear Model and Mean")
})
with(ep.df, {
plot(TOT~x,bg="Blue",pch=21,ylim=c(0,1.1*max(TOT)),xlim=c(min(x),max(x)), ylab = "Electric Prices (Cents per Kilowatthour)", xlab = "Year")
abline(h=mean(TOT))
segments(x,TOT,x,mean(TOT),col="Green")
mtext("Diff between Point and Mean")
})
library(s20x)
trendscatter(ep.df$TOT~ep.df$YEAR, f = 1, ylim = c(0,11), main = "Energy Prices ~ Years", xlab = "Year", ylab = "Energy Prices")
plot(ep.df$TOT~x, ylim = c(0, max(ep.df$TOT) + 1), xlim = c(0, max(x)), ylab = "Electric Prices (Cents per Kilowatthour)", xlab = "Year")
abline(ep.summary$b0hat, ep.summary$b1hat, lwd = 2, col = "Blue")
plot(ep.lm, which =1, pch = 19)
abline(mean(ep.lm$residuals)+1.5*sd(ep.lm$residuals),0)
abline(mean(ep.lm$residuals)-1.5*sd(ep.lm$residuals),0)
library(s20x)
normcheck(ep.lm, shapiro.wilk = TRUE)
trendscatter(ep.lm$residuals~ep.lm$fitted.values, f = 0.5, main = "Residuals ~ Fitted Values", ylab = "Residuals", xlab = "Fitted Values")
mean(ep.summary$yerr)
t.test(ep.summary$yerr, mu=0, conf.level = 0.95)
1-.9272^2
plot(ep.df$TOT~x, pch = 17, col = "Purple", ylab = "Electric Prices (Cents per Kilowatthour)", xlab = "Year")
abline(ep.summary$b0hat, ep.summary$b1hat)
abline(ep.summary$b0hat+2*sd(ep.lm$residuals), ep.summary$b1hat, h = 0, lty = 2, col = "Red")
abline(ep.summary$b0hat-2*sd(ep.lm$residuals), ep.summary$b1hat, h = 0, lty = 2, col = "Red")
summary(ep.lm)
ci=c()
t=abs(qt(0.05/2,length(x)-1))
ci[1]=ep.summary$b1hat-t*(0.006801)
ci[2]=ep.summary$b1hat+t*(0.006801)
ci
t=abs(qt(0.05/2,length(x)-1))
ci[1]=ep.summary$b0hat-t*(0.201234)
ci[2]=ep.summary$b0hat+t*(0.201234)
ci
library(s20x)
ciReg(ep.lm)
mypred = function(y, ep.lm){
predict(ep.lm)[y - 1960]
}
mypred(1961, ep.lm)
mypred(1991, ep.lm)
mypred(2011, ep.lm)
cooks20x(ep.lm)
plot(y=ep.lm$residuals,x=ep.df$YEAR, col= ifelse(ep.lm$residuals >= 0.9, "Red", ifelse(ep.lm$residuals <= -0.9, "red", "Black")), pch = 10)
abline(0.9,0)
abline(-0.9,0)
outliers = c()
ctr = 1
for(i in 1:length(ep.lm$residuals)){
if(ep.lm$residuals[i] >= 0.9){
outliers[ctr] = ep.df$YEAR[i]
ctr = ctr + 1
}
if(ep.lm$residuals[i] <= -0.9){
outliers[ctr] = ep.df$YEAR[i]
ctr = ctr + 1
}
}
outliers
