---
title: "Assignment 4"
author: "Clayton Glenn"
date: "April 15, 2018"
output:
  html_document:
    fig_caption: yes
    fig_height: 4
    fig_width: 5
    number_sections: yes
    toc: yes
  pdf_document: default
  word_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
getwd()
```

10/10 Completed

#Question 1

##A

```{r}
birds.df <- read.csv("NZBIRDS.csv", header = TRUE)
x <- birds.df[sample(nrow(birds.df),35, replace = FALSE, prob = NULL),]
head(x)
```

##B

\[Mean=\bar Y=\sum^n_{i=1}\frac{y_i}{n}\]
\[Standard\ Deviation=s=\sqrt{\frac{\sum^n_{i=1}(y_i-\bar Y)^2}{n-1}}\]
\[Confidence\ Interval\ of\ Y=\bar Y\ ^+_- t_{a/2}\frac{s_y}{\sqrt{n_y}}\]
```{r}
mean(x$Body.Mass)
sd(x$Body.Mass)
ci=c()
t=abs(qt(0.05/2,34))
ci[1]=mean(x$Body.Mass)-t*sd(x$Body.Mass)/sqrt(35)
ci[2]=mean(x$Body.Mass)+t*sd(x$Body.Mass)/sqrt(35)
ci
```

##C

We are 95% confident that the mean of the population lies within this interval based off the random sample taken from the data.

##D

\[Mean=\mu=\sum^n_{i=1}\frac{x_i}{n}\]
```{r}
mean(birds.df$Body.Mass)
```
We now know that the actual population mean lies within our interval that we were 95% confident in.

##E

```{r}
mean(x$Egg.Length,na.rm=TRUE)
sd(x$Egg.Length,na.rm=TRUE)
ci[1]=mean(x$Egg.Length,na.rm=TRUE)-t*sd(x$Egg.Length,na.rm=TRUE)/sqrt(35)
ci[2]=mean(x$Egg.Length,na.rm=TRUE)+t*sd(x$Egg.Length,na.rm=TRUE)/sqrt(35)
ci
```

```{r}
mean(birds.df$Egg.Length,na.rm=TRUE)
```

As we can see from the confidence inteval, we can tell that the mean egg length of the population lies within the sample's confidence interval.

\[CI\ of\ \hat P_e-\hat P_n=(\hat p_e-\hat p_n)\^+_-z_{a/2}\sqrt{\frac{s^2_e}{n_e}+\frac{s^2_n}{n_n}}\]
\[\hat P_e=\frac{Y}{n}=\frac{21}{38}=0.5526\]
\[\hat P_n=\frac{Y}{n}=\frac{7}{78}=0.0897\]
\[S=npq\] 

```{r}
z = abs(qnorm((1-.95)/2))
ci[1]=(0.5526-0.0897)-z*sqrt(0.5*0.5+0.5*0.5)
ci[2]=(0.5526-0.0897)+z*sqrt(0.5*0.5+0.5*0.5)
ci
```

Since the 95% confidence interval is [-1,2], we can say the proportion of Flightless birds are more extinct.



#Question 2

```{r}
z = abs(qnorm((1-.90)/2)) 
ci[1]=(1312-1352)-z*sqrt((422^2)/100+(271^2)/47)
ci[2]=(1312-1352)+z*sqrt((422)^2/100+(271)^2/47)
ci
```

```{r}
f = qf((1-0.95), 46,99)
ci[2]=422^2/(271^2*f)
ci[1]=422^2*(f/271^2)
ci
```



#Question 3

\[Z=\frac{Y-\mu}{\sigma}=\frac{Y-0}{\sigma}=\frac{Y}{\sigma}\]
Multiply both sides by Z
\[Z^2=\frac{YZ}{\sigma}=\frac{YY}{\sigma\sigma}=\frac{Y^2}{\sigma^2}\]
With 1 degree freedom
\[P(X^2_{1-\alpha/2}\leq\frac{Y^2}{\sigma^2}\leq X^2_{\alpha/2})=1-\alpha\]
\[P(\frac{X^2_{1-\alpha/2}}{Y^2}\leq \frac{1}{\sigma^2}\leq \frac{X^2_{\alpha/2}}{Y^2})=1-\alpha\]
\[P(\frac{Y^2}{X^2_{1-\alpha/2}}\geq \sigma^2 \geq\frac{Y^2}{X^2_{\alpha/2}})=1-\alpha\]



#Question 4

##A

```{r}
x <- c(1.72,2.5,2.16,2.13,1.06,2.24,2.31,2.03,1.09,1.4,2.57,2.64,1.26,2.05,1.19,2.13,1.27,1.51,2.41,1.95)
t.test(x,mu=2)
```
The P-value of the t test is much greater than 0.05. Should not reject null hypothesis.

##B

Test statistic is -1.02 and P-Value is 0.322.

##C

The P-value of the t test is much greater than 0.05. Should not reject null hypothesis.

##D

T.Test allows for testing over confidence intervals just like calculations of intervals.



#Question 5

```{r}
x <- c(9.6,4.5,13.2,4.1,22.6,2.7,14.7,3.5,13.6,19.8,14.3,56.9,25.1,18.4,2.7,4.2,30.2,10.3,17.6,2.4,17.3,38.8,3.0,5.8,7.6)
sd(x)
t.test(x,mu=15,conf.level = .1)
```

\[t=\frac{\bar y - \mu_0}{s/\sqrt{n}}\]
\[t=\frac{14.52 - 15}{12.96/\sqrt{25}}=-.0185\]

##B

\[t=\frac{\bar y - \mu_0}{s/\sqrt{n}}\Rightarrow t(s/\sqrt{n})=\bar y - \mu_0\Rightarrow \bar y=\mu_0\ ^+_-t(s/\sqrt{n})\]
\[\bar y=15 -1.711(12.96/\sqrt{25})=10.565\]
\[\bar y=15 +1.711(12.96/\sqrt{25})=19.435\]
\[P(t<\frac{10.565-14}{2.592})+P(t>\frac{19.435-14}{2.592})=P(t<-1.33)+P(t>2.1)=.0980+.0232=0.1212\]
The likelyhood that the test will detect the mean is 14 g/m3 is 12.12%



#Question 6

\[S^2_P=\frac{(n_1-1)S^2_1+(n_2-1)S^2_2}{n_1+n_2-2}=\frac{7(.1186^2)+3(.1865^2)}{10}=0.02028\]
\[t=\frac{(\bar y_1-\bar y_2)}{\sqrt{S^2_P(1/n_1+1/n_2)}}=\frac{.2738-.4521}{.02028(3/8)}=-2.045\]



#Question 7

##A

```{r}
sam1=rnorm(21,mean=9764,sd=639)
sam2=rnorm(7,mean=12312,sd=2652)
sam3=rnorm(39,mean=11544,sd=1279)
var.test(sam2,sam3,var=1,conf.level = 1-.05/2)
qf(c(.05/2,1-.05/2),6,38)
2.763
```

##B

```{r}
var.test(sam1,sam2,var=1,conf.level = 1-.05/2)
qf(c(.05/2,1-.05/2),6,20)
3.13
```



#Question 8

```{r}
gobi.df<-read.csv("GOBIANTS.csv",header=TRUE,sep = ",")

dry.df = within(gobi.df, {
  reg <- ifelse(Region == "Gobi Desert", "GS","DS")
  reg<-factor(reg)
})

des.df = subset(gobi.df,subset=Region=="Gobi Desert")
var.test(x=dry.df[dry.df$reg == "DS",]$AntSpecies,y=des.df$AntSpecies,conf.level = 0.95)
```

##A

\[H_0=1,\ H_a\neq1\]

##B

The test statistic is 1.3684

##C

The rejection region is (0.1852,12.8146)

##D

The P-Value of the test is 0.7264

##E

The P-Value is much higher than 0.05 and the true ratio is not 1, so the variances arent equal.

##F

To accept equal variances with this small of a sample, the P-Value must be under 0.05 and the ratio needs to equal 1.



#Question 9

\[t=\frac{\bar d-d_0}{S_d/\sqrt{n}}=\frac{-32.6-0}{35/\sqrt{8}}=-2.63\]
With degree freedom = 7, \[-2.365\leq T-value\leq2.365\]



#Question 10

```{r}
myboot<-function(iter=10000,x,fun="mean",alpha=0.05,...){
  n=length(x)
  y=sample(x,n*iter,replace=TRUE)
  rs.mat=matrix(y,nr=n,nc=iter,byrow=TRUE)
  xstat=apply(rs.mat,2,fun) 
  ci=quantile(xstat,c(alpha/2,1-alpha/2))
  para=hist(xstat,freq=FALSE,las=1,
            main=paste("Histogram of Bootstrap sample statistics","\n","alpha=",alpha," iter=",iter,sep=""),
            ...)
  mat=matrix(x,nr=length(x),nc=1,byrow=TRUE)
  pte=apply(mat,2,fun)
  abline(v=pte,lwd=3,col="Black")
  segments(ci[1],0,ci[2],0,lwd=4) 
  text(ci[1],0.05,paste("(",round(ci[1],2),sep=""),col="Red",cex=2)
  text(ci[2],0.05,paste(round(ci[2],2),")",sep=""),col="Red",cex=2)
  t=abs(qt(alpha/2,df=n-1))
  cit = c()
  cit[1]=mean(x)-t*sd(x)/sqrt(n)
  cit[2]=mean(x)+t*sd(x)/sqrt(n)
  text(cit[1],.15,paste("(",round(cit[1],2),sep=""),col="Blue",cex=2)
  text(cit[2],.15,paste(round(cit[2],2),")",sep=""),col="Blue",cex=2)
  text(pte,max(para$density)/2,round(pte,2),cex=2)
  return(list(fun=fun,x=x,t=t,ci=ci,cit=cit))
}
set.seed(35); sam<-round(rnorm(30,mean=20,sd=3),3)
myboot(10000,x=sam,alpha=0.05,xlab="mean",col=rainbow(length(x)))
``` 