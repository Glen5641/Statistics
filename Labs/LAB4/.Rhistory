setwd("~/Stat Methods/Labs/LAB4")
knitr::opts_chunk$set(echo = TRUE)
getwd()
getwd()
read.table("SPRUCE.csv", header=TRUE,sep=”,”)
read.table("SPRUCE.csv", header=TRUE,sep=”,”)
read.csv("SPRUCE.csv", header=TRUE)
spruce.df <- read.csv("SPRUCE.csv", header=TRUE)
tail(spruce.df)
spruce.df <- read.csv("SPRUCE.csv", header=TRUE)
tail(spruce.df)
library(s20x)
trendscatter(Height~BHDiameter,f=0.5,data=spruce.df)
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
summary(spruce.lm)
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
summary(spruce.lm)
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
residuals(spruce.lm)
spruce.lm <- lm(Height ~ BHDiameter, data = spruce.df)
height.res <- residuals(spruce.lm)
spruce.lm <- lm(Height ~ BHDiameter, data = spruce.df)
height.res <- residuals(spruce.lm)
height.fit <- fitted(spruce.lm)
plot(height.res)
plot(height.fit)
plot(height.res)
plot(height.res ~ height.fit)
library(s20x)
trendscatter(height.res ~ height.fit)
plot(spruce.lm, which =1)
library(s20x)
normcheck(spruce.lm,shapiro.wilk = TRUE)
plot(Height~BHDiameter, data = spruce.df)
abline(quad.lm)
quad.lm=lm(Height~BHDiameter + I(BHDiameter^2),data=spruce.df)
plot(Height~BHDiameter, data = spruce.df)
abline(quad.lm)
anova(spruce.lm)
myplot=function(x){
quad.lm$coef[1] +quad.lm$coef[2]*x  + quad.lm$coef[3]*x^2
}
curve(myplot, lwd=2, col="steelblue",add=TRUE)
plot(quad.lm, which=1)
curve(myplot, lwd=2, col="steelblue",add=TRUE)
quad.lm=lm(Height~BHDiameter + I(BHDiameter^2),data=spruce.df)
plot(Height~BHDiameter, data = spruce.df)
myplot=function(x){
quad.lm$coef[1] +quad.lm$coef[2]*x  + quad.lm$coef[3]*x^2
}
curve(myplot, lwd=2, col="steelblue",add=TRUE)
quad.fit <- fitted(quad.lm)
plot(quad.lm)
quad.lm$coef[1] +quad.lm$coef[2]*x  + quad.lm$coef[3]*x^2
}
plot(Height~BHDiameter, data = spruce.df)
curve(myplot, lwd=2, col="steelblue",add=TRUE)
plot(quad.lm)
plot(Residuals ~ Fitted values, data = quad.lm)
plot(Residuals ~ Fitted, data = quad.lm)
plot(residuals(quad.lm) ~ fitted(quad.lm))
plot(residuals(quad.lm) ~ fitted(quad.lm))
normcheck(quad.lm,shapiro.wilk = TRUE)
plot(residuals(quad.lm) ~ quad.fit)
quad.fit <- fitted(quad.lm)
quad.res <- residuals(quad.lm)
plot(quad.res ~ quad.fit)
summary(quad.lm)
quad.lm$coef[1]
quad.lm$coef[1]
quad.lm$coef[2]
quad.lm$coef[3]
summary(quad.lm)
quad.lm$coef[1]
quad.lm$coef[2]
quad.lm$coef[3]
predict(15, data = spruce.df)
predict(15, data = spruce.lm)
predict(quad.lm, data.frame(BHDiameter=c(15,18,20)))
predict(spruce.lm, data.frame(BHDiameter=c(15,18,20)))
with(spruce.df,predict(spruce.lm,data.frame(BHDiameter)))
ciReg(quad.lm)
library(s20x)
trendscatter(Height ~ BHDiameter, f = 0.5, data = spruce.df)
plot(height.res ~ height.fit)
library(s20x)
trendscatter(height.res ~ height.fit)
plot(spruce.lm, which =1)
library(s20x)
normcheck(spruce.lm,shapiro.wilk = TRUE)
quad.lm=lm(Height~BHDiameter + I(BHDiameter^2),data=spruce.df)
myplot=function(x){
quad.lm$coef[1] +quad.lm$coef[2]*x  + quad.lm$coef[3]*x^2
}
plot(Height~BHDiameter, data = spruce.df)
curve(myplot, lwd=2, col="steelblue",add=TRUE)
plot(quad.res ~ quad.fit)
normcheck(quad.lm,shapiro.wilk = TRUE)
summary(quad.lm)
quad.lm$coef[1]
quad.lm$coef[2]
quad.lm$coef[3]
predict(quad.lm, data.frame(BHDiameter=c(15,18,20)))
predict(spruce.lm, data.frame(BHDiameter=c(15,18,20)))
knitr::opts_chunk$set(echo = TRUE)
getwd()
spruce.df <- read.csv("SPRUCE.csv", header=TRUE)
tail(spruce.df)
quad.lm=lm(Height~BHDiameter + I(BHDiameter^2),data=spruce.df)
myplot=function(x){
quad.lm$coef[1] +quad.lm$coef[2]*x  + quad.lm$coef[3]*x^2
}
plot(Height~BHDiameter, data = spruce.df)
quad.lm=lm(Height~BHDiameter + I(BHDiameter^2),data=spruce.df)
myplot=function(x){
quad.lm$coef[1] +quad.lm$coef[2]*x  + quad.lm$coef[3]*x^2
}
plot(Height~BHDiameter, data = spruce.df)
curve(myplot, lwd=2, col="steelblue",add=TRUE)
library(s20x)
cooks20x(quad.lm)
quad2.lm=lm(Height~BHDiameter + I(BHDiameter^2) , data=spruce.df[-24,])
summary(quad2.lm)
anova(spruce.lm,quad.lm)
anova(quad.lm)
anova(spruce.lm)
RSS <- with(spruce.df, sum((Height-height.qfit)^2))
RSS <- with(spruce.df, sum((Height-height.fit)^2))
MSS <- with(spruce.df, sum((height.qfit-mean(Height))^2))
RSS <- with(spruce.df, sum((Height-quad.fit)^2))
MSS <- with(spruce.df, sum((quad.fit-mean(Height))^2))
TSS <- with(spruce.df, sum((Height-mean(Height))^2))
RSS
MSS
TSS
MSS/TSS
with(spruce.df,predict(spruce.lm,data.frame(BHDiameter)))
with(spruce.df,predict(quad.lm,data.frame(BHDiameter)))
plot(spruce.lm, which =1)
plot(height.res ~ height.fit, ylab = "Residuals", xlab = "Fitted Values")
plot(height.res ~ height.fit)
plot(spruce.lm, which =1)
normcheck(spruce.lm,shapiro.wilk = TRUE)
library(s20x)
cooks20x(quad.lm)
(with(spruce.df, sum((Height-mean(Height))^2))-with(spruce.df, sum((Height-quad.fit)^2)))/with(spruce.df, sum((Height-mean(Height))^2))
(with(spruce.df, sum((Height-mean(Height))^2))-with(spruce.df, sum((Height-spruce.fit)^2)))/with(spruce.df, sum((Height-mean(Height))^2))
(with(spruce.df, sum((Height-mean(Height))^2))-with(spruce.df, sum((Height-spruce.fit)^2)))/with(spruce.df, sum((Height-mean(Height))^2))
(with(spruce.df, sum((Height-mean(Height))^2))-with(spruce.df, sum((Height-height.fit)^2)))/with(spruce.df, sum((Height-mean(Height))^2))
anova(spruce.lm,quad.lm)
anova(quad.lm)
anova(spruce.lm)
RSS <- with(spruce.df, sum((Height-quad.fit)^2))
MSS <- with(spruce.df, sum((quad.fit-mean(Height))^2))
TSS <- with(spruce.df, sum((Height-mean(Height))^2))
RSS
MSS
TSS
MSS/TSS
library(s20x)
cooks20x(quad.lm)
library(s20x)
cooks20x(quad.lm)
mean(spruce.df$Height)
quad2.lm=lm(Height~BHDiameter + I(BHDiameter^2) , data=spruce.df[-24,])
summary(quad2.lm)
summary(quad.lm)
knitr::opts_chunk$set(echo = TRUE)
ddt = read.csv("DDT.csv", header = TRUE)
head(ddt)
View(ddt)
libarary(s20x)
library(s20x)
with(ddt, {
trendscatter(LENGTH ~ WEIGHT,f=0.5)
})
library(s20x)
with(ddt, {
trendscatter(LENGTH ~ WEIGHT,f=0.3)
})
